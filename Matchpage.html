<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Include Material Design lite framework -->
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.2.1/material.indigo-pink.min.css">
    <script defer src="https://code.getmdl.io/1.2.1/material.min.js"></script>

    <title>Lughborough Table Tennis Cup</title>
    <link rel="stylesheet" type="text/css" href="CupPage.css">
    <link rel="stylesheet" type="text/css" href="Matchpage.css">

</head>
<body>

<script src="https://unpkg.com/vue/dist/vue.js"></script>  <!-- include vue.js -->

    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
        <header class="mdl-layout__header">
            <div class="mdl-layout__header-row">
                <!-- Title -->
                <span class="mdl-layout-title">Loughborough Table Tennis Cup</span>
                <!-- Add spacer, to align navigation to the right -->
                <div class="mdl-layout-spacer"></div>
                <!-- Navigation. We hide it in small screens. -->
                <nav class="mdl-navigation mdl-layout--large-screen-only">
                    <a class="mdl-navigation__link" href="NewCup.html">Group stage info</a>
                    <a class="mdl-navigation__link" href="CupPage.html">Playoffs info</a>
                    <a class="mdl-navigation__link" href="">Fixtures</a>
                    <a class="mdl-navigation__link" href="">Teams</a>
                    <a class="mdl-navigation__link" href="login.html">Login</a>
                </nav>
            </div>
        </header>                                                                                                           <!-- FIX ME -->
        <div class="mdl-layout__drawer">
            <span class="mdl-layout-title">Navigation</span>
            <nav class="mdl-navigation">
                <a class="mdl-navigation__link" href="NewCup.html">Group stage info</a>
                <a class="mdl-navigation__link" href="CupPage.html">Playoffs info</a>
                <a class="mdl-navigation__link" href="">Fixtures</a>
                <a class="mdl-navigation__link" href="">Teams</a>
                <a class="mdl-navigation__link" href="login.html">Login</a>
            </nav>
        </div>

    <main class="mdl-layout__content" id="calc">
        <div id="app">
            <p class="date">Date</p>
            <table >                                                                                                     <!-- This is the top table containing the team names and so on-->
                <tr >
                    <td class="cell-border center">Home</td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td class="cell-border center">Away</td>
                </tr>
                <tr>
                    <td class="cell-border title-text">Loughboroug</td>
                    <td class="cell-border title-text">3</td>
                    <td class="cell-border ">VS</td>
                    <td class="cell-border title-text">4</td>
                    <td class="cell-border title-text">Leicester</td>
                </tr>
                <tr >
                    <td class="cell-border center">
                        Gareth <br>
                    </td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td class="cell-border center">
                        Will <br>
                    </td>
                </tr>
            </table>
            <br> <br>
                <!-- This is the second table containing the singles-->
            <table class="scorestable" >
                    <!-- this just contains the singles subtitle -->
                <tr>
                    <td><a class="title-text">Singles:</a></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td colspan="2" class="teamnamecell" align="center"><b>Loughborough</b></td>
                    <td></td>
                    <td align="center" style="width: 50px">Home</td>
                    <td align="center" style="width: 50px">Away</td>
                </tr>
                <tr >
                    <td ></td>
                    <td></td>
                    <td align="center" class="teamnamecell">  Gareth Liughing </td>
                    <td align="center" class="teamnamecell">  Riccardo boscherini</td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td rowspan="2" class="teamnamecell"> <b>Loughborough</b></td>
                    <td class="teamnamecell"> Robert Davis</td>

                    <!-- Match 1:  player 1 VS player 1-->
                    <td class="setcell">

                        <table class="game-table" v-bind:class="{ active: m1g1h < m1g1a, greentrue: m1g1h > m1g1a }">
                            <tr><td class="e"></td><td class="t" align="right">{{m1g1h}}</td></tr>
                            <tr><td class="b" align="left">{{m1g1a}}</td> <td class="e"></td></tr>
                        </table>
                        <table class="game-table" v-bind:class="{ active: m1g2h < m1g2a, greentrue: m1g2h > m1g2a }">
                            <tr><td class="e"></td><td class="t" align="right" >{{m1g2h}}</td></tr>
                            <tr><td class="b" align="left">{{m1g2a}}</td> <td class="e"></td></tr>
                        </table>
                        <table class="game-table" v-bind:class="{ active: m1g3h < m1g3a, greentrue: m1g3h > m1g3a }">
                            <tr><td class="e"></td><td class="t" align="right">{{m1g3h}}</td></tr>
                            <tr><td class="b" align="left">{{m1g3a}}</td> <td class="e"></td></tr>
                        </table>
                        <table class="game-table" v-bind:class="{ active: m1g4h < m1g4a, greentrue: m1g4h > m1g4a }">
                            <tr><td class="e"></td><td class="t" align="right">{{m1g4h}}</td></tr>
                            <tr><td class="b" align="left">{{m1g4a}}</td> <td class="e"></td></tr>
                        </table>

                    </td>
                    <!-- Match 2:  player 1 VS player 2-->
                    <td class="setcell">
                        <table class="game-table" v-bind:class="{ active: m2g1h < m2g1a, greentrue: m2g1h > m2g1a }">
                            <tr><td class="e"></td><td class="t" align="right">{{m2g1h}}</td></tr>
                            <tr><td class="b" align="left">{{m2g1a}}</td> <td class="e"></td></tr>
                        </table>
                        <table class="game-table" v-bind:class="{ active: m2g2h < m2g2a, greentrue: m2g2h > m2g2a }">
                            <tr><td class="e"></td><td class="t" align="right">{{m2g2h}}</td></tr>
                            <tr><td class="b" align="left">{{m2g2a}}</td> <td class="e"></td></tr>
                        </table>
                        <table class="game-table" v-bind:class="{ active: m2g3h < m2g3a, greentrue: m2g3h > m2g3a }">
                            <tr><td class="e"></td><td class="t" align="right" >{{m2g3h}}</td></tr>
                            <tr><td class="b" align="left">{{m2g3a}}</td> <td class="e"></td></tr>
                        </table>
                        <table class="game-table" v-bind:class="{ active: m2g4h < m2g4a, greentrue: m2g4h > m2g4a }">
                            <tr><td class="e"></td><td class="t" align="right" >{{m2g4h}}</td></tr>
                            <tr><td class="b" align="left" >{{m2g4a}}</td> <td class="e"></td></tr>
                        </table>
                    </td>
                    <td ></td>
                    <td align="center" class="totalscorecell" id="homepart1" ></td>
                    <td align="center" class="totalscorecell" id="awaypart1" ></td>
                </tr>
                <tr >
                    <td class="teamnamecell">Riccardo boscherini</td>
                    <!-- Match 3:  player 2 VS player 1-->
                    <td class="setcell">
                        <table class="game-table" v-bind:class="{ active: m3g1h < m3g1a, greentrue: m3g1h > m3g1a }">
                            <tr><td class="e"></td><td class="t" align="right" >{{m3g1h}}</td></tr>
                            <tr><td class="b" align="left">{{m3g1a}}</td> <td class="e"></td></tr>
                        </table>
                        <table class="game-table" v-bind:class="{ active: m3g2h < m3g2a, greentrue: m3g2h > m3g2a }">
                            <tr><td class="e"></td><td class="t" align="right">{{m3g2h}}</td></tr>
                            <tr><td class="b" align="left" >{{m3g2a}}</td> <td class="e"></td></tr>
                        </table>
                        <table class="game-table" v-bind:class="{ active: m3g3h < m3g3a, greentrue: m3g3h > m3g3a }">
                            <tr><td class="e"></td><td class="t" align="right">{{m3g3h}}</td></tr>
                            <tr><td class="b" align="left">{{m3g3a}}</td> <td class="e"></td></tr>
                        </table>
                        <table class="game-table" v-bind:class="{ active: m3g4h < m3g4a, greentrue: m3g4h > m3g4a }">
                            <tr><td class="e"></td><td class="t" align="right">{{m3g4h}}</td></tr>
                            <tr><td class="b" align="left">{{m3g4a}}</td> <td class="e"></td></tr>
                        </table>
                    </td>
                    <!-- Match 4:  player 2 VS player 2-->
                    <td class="setcell">
                        <table class="game-table" v-bind:class="{ active: m4g1h < m4g1a, greentrue: m4g1h > m4g1a }">
                            <tr><td class="e"></td><td class="t" align="right">{{m4g1h}}</td></tr>
                            <tr><td class="b" align="left">{{m4g1a}}</td> <td class="e"></td></tr>
                        </table>
                        <table class="game-table" v-bind:class="{ active: m4g2h < m4g2a, greentrue: m4g2h > m4g2a }">
                            <tr><td class="e"></td><td class="t" align="right" >{{m4g2h}}</td></tr>
                            <tr><td class="b" align="left">{{m4g2a}}</td> <td class="e"></td></tr>
                        </table>
                        <table class="game-table" v-bind:class="{ active: m4g3h < m4g3a, greentrue: m4g3h > m4g3a }">
                            <tr><td class="e"></td><td class="t" align="right">{{m4g3h}}</td></tr>
                            <tr><td class="b" align="left">{{m4g3a}}</td> <td class="e"></td></tr>
                        </table>
                        <table class="game-table" v-bind:class="{ active: m4g4h < m4g4a, greentrue: m4g4h > m4g4a }">
                            <tr><td class="e"></td><td class="t" align="right">{{m4g4h}}</td></tr>
                            <tr><td class="b" align="left">{{m4g4a}}</td> <td class="e"></td></tr>
                        </table>
                    </td>
                    <td ></td>
                    <td align="center" class="totalscorecell" id="homepart2"></td>
                    <td align="center" class="totalscorecell" id="awaypart2"></td>
                </tr>

            </table>
            <br>

            <table class="scorestable" >
                <!-- this just contains the singles subtitle -->
                <tr>
                    <td><a class="title-text">Doubles:</a></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td colspan="2" class="teamnamecell" align="center"></td>
                    <td></td>
                    <td align="center" style="width: 50px"></td>
                    <td align="center" style="width: 50px"></td>
                </tr>
                <tr >
                    <td ></td>
                    <td></td>
                    <td align="center" class="teamnamecell">  Gareth Liughing & Riccardo Boscherini </td>
                    <td align="center" class="teamnamecell">  </td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td rowspan="2" class="teamnamecell"> </td>
                    <td class="teamnamecell"> Robert Davis</td>

                    <!-- Match 1:  player 1 VS player 1-->
                    <td class="setcell">

                        <table class="game-table" v-bind:class="{ active: m1g1h < m1g1a, greentrue: m1g1h > m1g1a }">
                            <tr><td class="e"></td><td class="t" align="right">{{m1g1h}}</td></tr>
                            <tr><td class="b" align="left">{{m1g1a}}</td> <td class="e"></td></tr>
                        </table>
                        <table class="game-table" v-bind:class="{ active: m1g2h < m1g2a, greentrue: m1g2h > m1g2a }">
                            <tr><td class="e"></td><td class="t" align="right" >{{m1g2h}}</td></tr>
                            <tr><td class="b" align="left">{{m1g2a}}</td> <td class="e"></td></tr>
                        </table>
                        <table class="game-table" v-bind:class="{ active: m1g3h < m1g3a, greentrue: m1g3h > m1g3a }">
                            <tr><td class="e"></td><td class="t" align="right">{{m1g3h}}</td></tr>
                            <tr><td class="b" align="left">{{m1g3a}}</td> <td class="e"></td></tr>
                        </table>
                        <table class="game-table" v-bind:class="{ active: m1g4h < m1g4a, greentrue: m1g4h > m1g4a }">
                            <tr><td class="e"></td><td class="t" align="right">{{m1g4h}}</td></tr>
                            <tr><td class="b" align="left">{{m1g4a}}</td> <td class="e"></td></tr>
                        </table>

                    </td>
                    <!-- Match 2:  player 1 VS player 2-->
                    <td class="setcell"></td>
                    <td ></td>
                    <td align="center" class="totalscorecell" id="hdoubles" ></td>
                    <td align="center" class="totalscorecell" id="adoubles" ></td>
                </tr>

                <tr>

                    <td></td>
                    <td></td>
                    <td style="text-align: right">Handicap:</td>                                                    <!-- Fix the styling> -->
                    <td></td>
                    <td align="center" class="totalscorecell" id="hhandicap"></td>
                    <td align="center" class="totalscorecell" id="ahandicap"></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td style="text-align: right">Compensation:</td>                                                <!-- Fix the styling> -->
                    <td ></td>
                    <td align="center" class="totalscorecell" id="hcompensation"></td>
                    <td align="center" class="totalscorecell" id="acompensation"></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td style="text-align: right">Total:</td>                                                <!-- Fix the styling> -->
                    <td></td>
                    <td align="center" class="totalscorecell" id="homescore"></td>
                    <td align="center" class="totalscorecell" id="awayscore"></td>
                </tr>


            </table>

        </div>
        <br>
        <div id="calc">
            <button v-on:click="addup">Calculate Score</button>
            <button v-on:click="fetchSetScore(1)">Query</button>
            <button v-on:click="fetchPlayerInfo(1)">Player name</button>



        </div>
        <script>

            var tallier = new Vue({
                el: '#calc',
                data: {

                    redtrue: true,
                    greentrue: true,

                    homescore: 0,
                    awayscore: 0,
                    hhandicap:0,
                    ahandicap:0,
                    hcompensation:0,
                    acompensation:0,

                    m1g1h: 11,       m2g1h: 11,
                    m1g1a: 2,        m2g1a: 2,
                    m1g2h: 5,        m2g2h: 0,
                    m1g2a: 3,        m2g2a: 11,
                    m1g3h: 3,        m2g3h: 3,
                    m1g3a: 6,        m2g3a: 1,
                    m1g4h: 9,        m2g4h: 11,
                    m1g4a: 3,        m2g4a: 3,

                    m3g1h: 11,      m4g1h: 11,
                    m3g1a: 2,       m4g1a: 2,
                    m3g2h: 0,       m4g2h: 0,
                    m3g2a: 11,      m4g2a: 0,
                    m3g3h: 3,       m4g3h: 11,
                    m3g3a: 0,       m4g3a: 0,
                    m3g4h: 11,      m4g4h: 11,
                    m3g4a: 3,       m4g4a: 3,

                    m5g1h: 11,
                    m5g1a: 2,
                    m5g2h: 0,
                    m5g2a: 0,
                    m5g3h: 11,
                    m5g3a: 0,
                    m5g4h: 11,
                    m5g4a: 3

                },

                methods: {
                    addup: function () {

                        var homescore1 = this.m1g1h + this.m1g2h + this.m1g3h + this.m1g4h + this.m2g1h + this.m2g2h + this.m2g3h + this.m2g4h;
                        var awayscore1 = this.m1g1a + this.m1g2a + this.m1g3a + this.m1g4a + this.m2g1a + this.m2g2a + this.m2g3a + this.m2g4a;
                        var homescore2 = this.m3g1h + this.m3g2h + this.m3g3h + this.m3g4h + this.m4g1h + this.m4g2h + this.m4g3h + this.m4g4h;
                        var awayscore2 = this.m3g1a + this.m3g2a + this.m3g3a + this.m3g4a + this.m4g1a + this.m4g2a + this.m4g3a + this.m4g4a;
                        var hdoubles = this.m5g1h + this.m5g2h + this.m5g3h + this.m5g4h;
                        var adoubles = this.m5g1a + this.m5g2a + this.m5g3a + this.m5g4a;

                        document.getElementById("homepart1").innerHTML=homescore1;
                        document.getElementById("awaypart1").innerHTML=awayscore1;
                        document.getElementById("homepart2").innerHTML=homescore2;
                        document.getElementById("awaypart2").innerHTML=awayscore2;
                        document.getElementById("hdoubles").innerHTML=hdoubles;
                        document.getElementById("adoubles").innerHTML=adoubles;


                        this.homescore = homescore1 + homescore2 + hdoubles;
                        document.getElementById("homescore").innerHTML=this.homescore;
                        this.awayscore = awayscore1 + awayscore2 + adoubles;
                        document.getElementById("awayscore").innerHTML=this.awayscore;
                        //YOU NEED TO SET THE HANDICAP HERE                                                             //YOU NEED TO SET THE HANDICAP HERE

                    },

                    scorefetch: function (data) {

                        var xhttp = new XMLHttpRequest();
                        xhttp.onreadystatechange = function() {                                                         //(callback function)this function runs after xhttp.open because we have asynchronous data sending so as soon as the data is recieved this is run
                            if (xhttp.readyState === XMLHttpRequest.DONE && xhttp.status == 200) {
                                //here I manipulate the data received
                                console.log(this.responseText);                                                         //raw data received is posted for debugging purposes
                                tallier.scoreparser(this.responseText);
                            }
                        };

                        xhttp.open("GET", "http://localhost:3030/matches", true);
                        xhttp.send();


                    },
                    scoreparser: function (rawdata) {
                        //these two lines just parse the data so it can be accessed
                        var data =  rawdata;
                        var json = JSON.parse(data);                                                                    //parse json data
                        //console.log(json.id);

                        //this.m1g1a = json.id;
                    },

                    fetchSetScore: function (matchID) {

                        var xhttp = new XMLHttpRequest();
                        xhttp.onreadystatechange = function() {                                                         //(callback function)this function runs after xhttp.open because we have asynchronous data sending so as soon as the data is recieved this is run
                            if (xhttp.readyState === XMLHttpRequest.DONE && xhttp.status == 200) {
                                //here I manipulate the data received
                                console.log(this.responseText);                                                         //raw data received is posted for debugging purposes
                                tallier.parserSetScore(this.responseText);
                            }
                        };

                        xhttp.open("GET", "http://localhost:3030/sets/"+matchID, true);
                        xhttp.send();

                    },
                    parserSetScore: function (rawdata) {
                        //these two lines just parse the data so it can be accessed
                        var data =  rawdata;
                        var json = JSON.parse(data);
                        //console.log(json[0].g2h);


                        this.m1g1h = json[0].g1h;                                                                       //THIS SHOULD NOT BELONG HERE
                        this.m1g2h = json[0].g2h;
                        this.m1g3h = json[0].g3h;
                        this.m1g4h = json[0].g4h;
                        this.m1g1a = json[0].g1a;
                        this.m1g2a = json[0].g2a;
                        this.m1g3a = json[0].g3a;
                        this.m1g4a = json[0].g4a;


                        this.m2g1h = json[1].g1h;
                        this.m2g2h = json[1].g2h;
                        this.m2g3h = json[1].g3h;
                        this.m2g4h = json[1].g4h;
                        this.m2g1a = json[1].g1a;
                        this.m2g2a = json[1].g2a;
                        this.m2g3a = json[1].g3a;
                        this.m2g4a = json[1].g4a;

                        this.m3g1h = json[2].g1h;
                        this.m3g2h = json[2].g2h;
                        this.m3g3h = json[2].g3h;
                        this.m3g4h = json[2].g4h;
                        this.m3g1a = json[2].g1a;
                        this.m3g2a = json[2].g2a;
                        this.m3g3a = json[2].g3a;
                        this.m3g4a = json[2].g4a;

                        this.m4g1h = json[3].g1h;
                        this.m4g2h = json[3].g2h;
                        this.m4g3h = json[3].g3h;
                        this.m4g4h = json[3].g4h;
                        this.m4g1a = json[3].g1a;
                        this.m4g2a = json[3].g2a;
                        this.m4g3a = json[3].g3a;
                        this.m4g4a = json[3].g4a;

                    },

                    fetchPlayerInfo: function (playerID) {

                        var xhttp = new XMLHttpRequest();
                        xhttp.onreadystatechange = function() {                                                         //(callback function)this function runs after xhttp.open because we have asynchronous data sending so as soon as the data is recieved this is run
                            if (xhttp.readyState === XMLHttpRequest.DONE && xhttp.status == 200) {
                                //here I manipulate the data received
                                console.log(this.responseText);                                                         //raw data received is posted for debugging purposes
                                tallier.parserPlayerInfo(this.responseText);
                            }
                        };

                        xhttp.open("GET", "http://localhost:3030/player/"+playerID, true);
                        xhttp.send();

                    },

                    parserPlayerInfo: function (rawdata) {
                        //these two lines just parse the data so it can be accessed
                        var data =  rawdata;
                        var json = JSON.parse(data);

                        return json;            //simply returns the json structure
                    }


                }
            })

        </script>

    </main>

</div>
</body>
</html>

